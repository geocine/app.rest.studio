<div class="toolbar font-small">
    <div class="flex-100">
        <a *ngFor="let v of availableViews"
           class="link option" [ngClass]="{on: view === v}"
           (click)="switchView(v)">{{v | rsTitleCase}}</a>
    </div>
    <div class="flex-1 code" *ngIf="response">
        <span *ngIf="duration">{{duration}}ms</span>
        <span>{{response.status}}</span>
        <span>{{response.statusText}}</span>
    </div>
    <div>
        <a class="ion-eye link p-2" title="preview" *ngIf="previewable"> </a>
        <div class="btn-group">
            <a class="ion-arrow-expand large link p-2" title="full screen" (click)="toggleFullScreen()"> </a>
            <a class="link ion-grid large p-2" data-toggle="dropdown">
            </a>
            <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item link" (click)="digest()">View Digest</a>
                <a class="dropdown-item link" (click)="viewAsJson()">View As JSON</a>
                <a class="dropdown-item link" (click)="viewAsYaml()">View As YAML</a>
                <a class="dropdown-item link" (click)="viewAsHtml()">View As HTML</a>
                <a class="dropdown-item link" (click)="viewAsXml()">View As XML</a>
                <a class="dropdown-item link" (click)="clearResponse()">Clear</a>
            </div>
        </div>
    </div>
</div>
<div class="content" [ngSwitch]="view">
    <div class="flex flex-1" [hidden]="view + '' !== 'body'">
        <text-editor #editor [text]="bodyString" [mode]="bodyTextMode"
                     [observeText]="true"
                     [wrap]="true"
                     [lineNumbers]="true"
                     (onFullScreenChanged)="fullScreen = $event"></text-editor>
    </div>
    <div class="flex flex-1 p-2" *ngSwitchCase="'header'">
        <!--<pre class="flex-1 smaller" [innerHtml]="response?.headers | rsYaml | rsCode: 'yaml'"></pre>-->
        <table class="table table-striped table-sm smaller">
            <tbody>
            <tr *ngFor="let header of (response?.headers | rsSortKeys | rsToPairs)">
                <td class="b" style="min-width: 120px;">{{header.key}}</td>
                <td>{{header.value}}</td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="flex-1 p-2" *ngSwitchCase="'request'">
        <div class="p-1 smaller">
            <a class="option" [ngClass]="{on: !shareView}" (click)="shareView = false">Preview Request</a>
            <a class="option" [ngClass]="{on: shareView}" (click)="shareRequest()">Share Request</a>
        </div>
        <hr/>

        <pre class="smaller" [innerHtml]="(previewRequest || {}) | rsYaml | rsCode: 'yaml'" *ngIf="!shareView"></pre>
        <div *ngIf="shareView">
            <div class="p-2 d-flex justify-content-end">
                <a class="link option on smaller">Pretty</a>
            </div>
            <textarea [id]="'share_' + id" class="form-control smaller code"
                      rows="20">{{request | rsSortKeys | rsJson}}</textarea>

            <div id="xxx" class="p-2">
                <a class="btn btn-secondary btn-sm link copy" (click)="copyShare()"
                   [attr.data-clipboard-target]="'#share_' + id">Copy</a>
                <a class="btn btn-secondary btn-sm link" href="data:text/html,HelloWorld!" download="something.html">Download</a>
                <a class="btn btn-secondary btn-sm link" (click)="saveToCloud()" *ngIf="noOfConnections <= 1">
                    Save To Cloud
                </a>
            </div>

            <div class="p-2" *ngIf="request && noOfConnections > 0">
                <select [(ngModel)]="request.defaultBindId">
                    <option *ngFor="let con of connections" [value]="con.id">{{con.title}}</option>
                </select>

                <input class="form-control" [value]="request.sharedLink" *ngIf="request.sharedLink"/>
                <input #cloudPathInput class="form-control" placeholder="cloud storage path"
                       value="/app.rest.studio/requests/request[{{request.id}}].json"/>
                <button class="btn btn-sm btn-info" (click)="saveToCloud()">Save</button>
                <button class="btn btn-sm btn-info" (click)="generateSahredLink()">Generate Shared Link</button>
                <button class="btn btn-sm btn-info" (click)="downloadFromCloud()">Download From Cloud</button>
            </div>


            <!--            <div class="d-flex p-2">
                            <div class="p-2 m-2">
                                <h1 class="ion-social-dropbox p-2 m-2" style="font-size: 6em;"></h1>
                            </div>
                            <div>
                                <h3>Connect Dropbox</h3>
                                <p>Connect dropbox to store and share requests with collaborators</p>
                                <button class="btn btn-info link">Connect</button>
                            </div>
                        </div>-->
        </div>
    </div>
    <div class="flex flex-1 p-2" *ngSwitchCase="'schema'">
        <pre class="flex-1" [innerHtml]="(schema || {}) | rsYaml | rsCode: 'yaml'"></pre>
    </div>
    <div class="flex flex-1 p-2" *ngSwitchCase="'error'">
        <h1>Something goes wrong ... Have you installed the Chrome extension?</h1>
    </div>
</div>